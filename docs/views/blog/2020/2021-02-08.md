---
title: 使用github actions搭建可自动部署的个人静态网页
date: 2021-02-08
sidebarDepth: 1
tags:
 - blog
 - VuePress
 - github
categories: 
 - 网站搭建
---
## 前言

本教程旨在教学通过github pages托管一个静态网页并且结合github actions当执行push操作时能够自动更新网站内容。本教程中用到的静态网页模板为[vuepress-theme-reco](https://vuepress-theme-reco.recoluan.com/views/1.x/)，为了方便大家操作，本教程将网页模板的源代码放到了一个仓库中，大家只需要fork即可，不需要在电脑上安装node环境。

- 优点：通过配置github actions实现push之后网站内容自动进行更新且不需要服务器、域名等额外费用。

- 缺点：githubpages访问速度不是很快。

## 前置工作

1 在电脑上安装[git](https://git-scm.com/)

2 申请一个github账号

## github操作

### Fork

访问[这个代码仓库](https://github.com/yuyinws/vuepress),点击右上角的fork按钮即可，fork完成后进入自己的github页面，会发现多了一个仓库。

![image-20210208220853381](https://i.loli.net/2021/02/08/WZQK6UXmzHPFEbL.png)

### 创建分支

我们发现这个仓库中现在有一个master分支，这个master是我们的源代码分支，接下来我们需要创建一个新的分支，这个分支的作用是存放编译源代码后的文件。

点击master，在输入框中输入**gh-pages**,再点击**create branch**即可创建一个新的分支。

![image-20210208221302500](https://i.loli.net/2021/02/08/Wo2naPvMwhtIrCU.png)

### 生成授权码

依次右上角头像—Settings—Develop settings—Personal access token—Generate new token

输入token的名字，以及勾选repo。点击Generate toke即可生成一个token

![image-20210208221633298](https://i.loli.net/2021/02/08/nOFEV3m6c2sq1vx.png)



接着复制生成的授权码

![image-20210208221823164](https://i.loli.net/2021/02/08/wtRNoyVg7zqcrIn.png)

然后回到我们的仓库中。依次点击Settings—Secrets—New repository secret

名字输入**ACCESS_TOKEN**,将刚才复制的授权码输入到内容中，然后点击Add secret

![image-20210208222110526](https://i.loli.net/2021/02/08/rAs7X4Q5UCOJv8P.png)

### 指定github pages

在仓库中点击Setting—Options，先将我们的仓库名改成<你的用户名>.github.io这种形式

![image-20210208224947312](https://i.loli.net/2021/02/08/3xyu7kOACdHeqvl.png)



然后下拉到github pages这个选项，按下图进行配置。

![image-20210208222250643](https://i.loli.net/2021/02/08/BwLSh52VJDPE1st.png)

## 本地Git操作

第一步先复制github仓库的远程地址

![image-20210208225050413](https://i.loli.net/2021/02/08/aSHwPWqe8uYQz3p.png)

然后进入本地的git命令行，输入git clone <你的远程仓库地址>

clone完成之后会多出一个xxxx.github.io文件夹，在这个文件夹下面有一个package.json文件，把这个文件的第5行中username改成你自己的。

``` json
"homepage": "https://username.github.io",
```

然后在git命令行(需要进入vuepress根目录)中依次输入

``` git
git add .
git commit -m "init"
git push origin master
```

之后会弹出一个账号密码窗口，输入你的github的账号密码即可。

## 配置github actions

点击仓库中的Actions，选择一个模板，点击Set up

![image-20210208222438028](https://i.loli.net/2021/02/08/jhsIiH2kDTYa5rq.png)

在左侧输入框中复制以下代码

``` yaml
name: Deploy GitHub Pages

# 触发条件：在 push 到 master 分支后
on:
  push:
    branches:
      - master

# 任务
jobs:
  build-and-deploy:
    # 服务器环境：最新版 Ubuntu
    runs-on: ubuntu-latest
    steps:
      # 拉取代码
      - name: Checkout
        uses: actions/checkout@v2
        with:
          persist-credentials: false

      # 生成静态文件
      - name: Build
        run: npm install && npm run build

      # 部署到 GitHub Pages
      - name: Deploy
        uses: JamesIves/github-pages-deploy-action@releases/v3
        with:
          ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}
          BRANCH: gh-pages
          FOLDER: docs/.vuepress/dist

```

再点击右侧的Start Commit—Commit new file

![image-20210208224349103](https://i.loli.net/2021/02/08/x9Rf8Q3buchnFHZ.png)

这时点击Actions会发现github已经在执行一个部署任务了，等待几分钟。

![image-20210208224456441](https://i.loli.net/2021/02/08/8apGB2KvPyrUQqO.png)

等部署任务完成后再查看gh-pages分支，如果显示以下这些文件，那么恭喜你已经成功了！

![image-20210208224645764](https://i.loli.net/2021/02/08/sXy1IqJ86l3toHT.png)



赶快访问自己的github pages看看效果吧！

[效果演示](https://yuy1nws.github.io/)
